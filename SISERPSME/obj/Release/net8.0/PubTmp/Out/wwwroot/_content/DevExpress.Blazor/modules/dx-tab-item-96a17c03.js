import{_ as e}from"./tslib.es6-d65164b3.js";import{C as t}from"./custom-events-helper-e7f279d3.js";import{D as s,P as n,c as i,a as r,H as a,L as o}from"./dx-html-element-pointer-events-helper-3a1681ea.js";import{S as l}from"./single-slot-element-base-6c879161.js";import{dxTabsTag as d,TabsScrollMode as m}from"./ribbon-tabs-51ad7bb7.js";import{D as g}from"./dragging-helper-d7bfd9f1.js";import{C as c}from"./css-classes-c63af734.js";import{e as h}from"./custom-element-267f9a21.js";import"./dom-554d0cc7.js";import"./_commonjsHelpers-41cdd1e7.js";import"./common-48ec40e2.js";import"./browser-3fc721b7.js";import"./eventhelper-8bcec49f.js";import"./constants-7c047c0d.js";import"./devices-17b9ba08.js";import"./data-qa-utils-8be7c726.js";import"./const-90026e45.js";import"./dx-ui-element-38985cf5.js";import"./lit-element-base-be4d2d51.js";import"./dx-license-7b9121f4.js";import"./lit-element-462e7ad3.js";import"./logicaltreehelper-39bf56ef.js";import"./layouthelper-b10d5065.js";import"./point-e4ec110e.js";import"./property-4ec0b52d.js";import"./scroll-viewer-css-classes-e724f203.js";import"./toolbar-css-classes-d303c118.js";import"./constants-ed9663d1.js";import"./dom-utils-d057dcaa.js";import"./ribbon-utils-2b6a64cb.js";import"./focus-utils-d076e44c.js";import"./key-ffa272aa.js";import"./touch-6a322081.js";import"./disposable-d2c2d283.js";import"./events-f873e646.js";var p;let b=p=class extends l{constructor(){super(...arguments),this.boundOnDragStartHandler=this.handleDragStart.bind(this),this.boundOnDragStopHandler=this.handleDrop.bind(this),this.boundOnDragCancelHandler=this.handleDragEnd.bind(this),this._pointerEventsHelper=new s(this)}handleDragStart(e){p.draggingHelper.start(this,e.detail.source)}handleDragEnd(e){p.draggingHelper.stop()}handleDrop(e){if(p.draggingHelper.isValidTarget(this)){const e=p.draggingHelper.getDragIndex(),t=p.draggingHelper.getDropIndex();e!==t&&this.dispatchEvent(new u(e,t))}p.draggingHelper.stop()}isDraggableTab(){return this.tabs.allowTabReorder}get tabs(){return this.closest(d)}connectedCallback(){super.connectedCallback(),this.isDraggableTab()&&this.addEventSubscriptions(),this._pointerEventsHelper.initialize()}disconnectedCallback(){this.removeEventSubscriptions(),super.disconnectedCallback()}addEventSubscriptions(){this.addEventListener(n.eventName,this.boundOnDragStartHandler),this.addEventListener(i.eventName,this.boundOnDragCancelHandler),this.addEventListener(r.eventName,this.boundOnDragStopHandler)}removeEventSubscriptions(){this.removeEventListener(n.eventName,this.boundOnDragStartHandler),this.removeEventListener(i.eventName,this.boundOnDragCancelHandler),this.removeEventListener(r.eventName,this.boundOnDragStopHandler)}get handlePointerEventsMode(){return a.Dragging}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return o}get hoverTitleElementsSelector(){return null}get bypassNonInlineHoverTitleElementChildSelector(){return null}};b.draggingHelper=new class extends g{constructor(){super(...arguments),this.spacingElement=null,this.dragIndex=-1,this.dropIndex=-1,this._tabs=null,this.tabElements=null}start(e,t){super.start(e,t),this._tabs=e.closest(d);const s=e.closest("ul");this.tabElements=Array.from(s.querySelectorAll(":scope > li > .dxbl-tabs-item")),this.dragIndex=this.tabElements.indexOf(e),this.dropIndex=this.dragIndex,this.spacingElement=this.addSpacingElement(e),document.body.classList.add(c.GrabbingCursor)}stop(){var e,t;super.stop(),null===(e=this.spacingElement)||void 0===e||e.remove(),this.spacingElement=null,this.dropIndex=-1,null===(t=this.tabElements)||void 0===t||t.forEach((e=>this.clearAnimationStyles(e))),this.tabElements=null,document.body.classList.remove(c.GrabbingCursor)}isValidTarget(e){return this._tabs===e.tabs}getDragIndex(){return Number(this.tabElements[this.dragIndex].getAttribute("index"))}getDropIndex(){return Number(this.tabElements[this.dropIndex].getAttribute("index"))}addSpacingElement(e){const{width:t,height:s}=e.getBoundingClientRect(),n=document.createElement("li");return n.style.minWidth=`${t}px`,n.style.minHeight=`${s}px`,n.classList.add("dxbl-invisible"),e.parentElement?(e.parentElement.insertBefore(n,e),n):null}clearAnimationStyles(e){e.style.transform="",e.classList.remove("dxbl-tabs-item-drag-target")}getDraggableElement(e){const t=e.getBoundingClientRect();return e.style.position="fixed",e.style.top=`${t.top}px`,e.style.left=`${t.left}px`,e.classList.add("dxbl-state-dragging"),e}hideDraggableElement(){var e;super.hideDraggableElement();const t=null===(e=this.draggableContext)||void 0===e?void 0:e.dragableElement;t&&(t.style.position="",t.style.top="",t.style.left="",t.classList.remove("dxbl-state-dragging"))}onDocumentMouseMove(e){var t,s,n;super.onDocumentMouseMove(e);const i=e.target.closest(".dxbl-tabs-item");if(!i||!this.isValidTarget(i))return;const r=this.tabElements.indexOf(i);let a,o;const l=i.getBoundingClientRect(),d=null===(t=this._tabs)||void 0===t?void 0:t.scrollMode;(null===(s=this._tabs)||void 0===s?void 0:s.isHorizontal)?(o=l.x+l.width/2,a=e.clientX):(o=l.y+l.height/2,a=e.clientY);const g=i.parentElement,c=g.parentElement,h=this.dropIndex;if(a>o?(d===m.NoScroll&&c.insertBefore(this.spacingElement,g.nextSibling),this.dropIndex=r+1):(d===m.NoScroll&&c.insertBefore(this.spacingElement,g),this.dropIndex=r),this.dragIndex<this.dropIndex&&(this.dropIndex=this.dropIndex-1),d!==m.NoScroll){const e=(null===(n=this._tabs)||void 0===n?void 0:n.isHorizontal)?this.draggableContext.dragableElement.offsetWidth:this.draggableContext.dragableElement.offsetHeight;this.moveTabs(this.tabElements,this.dragIndex,h,this.dropIndex,e)}}moveTabs(e,t,s,n,i){const r=Math.max(t,Math.max(s,n)),a=Math.min(t,Math.min(s,n));if(n===a)for(let r=n;r<Math.min(s,t);++r)this.move(e[r],i);if(n===r)for(let r=Math.max(s,t+1);r<=n;++r)this.move(e[r],-i);if(s===a)for(let i=s;i<Math.min(n,t);++i)this.restorePosition(e[i]);if(s===r)for(let i=Math.max(t,n)+1;i<=s;++i)this.restorePosition(e[i])}move(e,t){var s;e.classList.add("dxbl-tabs-item-drag-target"),e.style.transform=(null===(s=this._tabs)||void 0===s?void 0:s.isHorizontal)?`translate(${t}px, 0px)`:`translate(0px, ${t}px)`}restorePosition(e){e.style.transform=""}updateDraggableElementPosition(){if(super.updateDraggableElementPosition(),!this.draggableContext)return;const e=this.draggableContext;e.draggableElementPosition={x:e.draggableElementPosition.x-e.initialCursorPosition.x,y:e.draggableElementPosition.y-e.initialCursorPosition.y}}},b=p=e([h("dxbl-tab-item")],b);class u extends CustomEvent{constructor(e,t){super(u.eventName,{detail:new v(e,t),bubbles:!0,composed:!0,cancelable:!0})}}u.eventName="dxbl-tab-reorder";class v{constructor(e,t){this.fromIndex=e,this.toIndex=t}}t.register(u.eventName,(e=>e.detail));export{b as DxTabItem,u as DxTabReorderEvent,v as OnTabReorderContext};
